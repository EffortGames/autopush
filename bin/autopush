#!/usr/bin/env bash
#
# Stages the local directory and commits using an autogenerated message.
# Fetches, rebases and pushes the current branch to the remote.
# Supports remote `origin` only
#
set -e -o pipefail

autocommit $1

COLOR='\033[0;36m'
COLOR_END='\033[0m'

branch=$(git rev-parse --abbrev-ref HEAD)
printf "@ ${COLOR}git fetch${COLOR_END}\n"
git fetch origin
printf "@ ${COLOR}git rebase${COLOR_END}\n"
git rebase origin/"${branch}"
printf "@ ${COLOR}git push${COLOR_END}\n"
git push origin "${branch}"
